import requests
from bs4 import BeautifulSoup as bs
import json
import re
import csv

''' 
撈取starbucks的分店資訊，首先，取得官網上各縣市的下拉欄位值，再依各縣市
的欄位值套入post的form中，撈取各縣市的分店資訊，整理後儲存為 csv 檔案 
'''

# 撈取 starbucks 的縣市資訊，再從縣市資訊撈取分店
list_city = []
start_url = 'http://www.starbucks.com.tw/stores/storesearch.jspx'
res = requests.get(start_url)
bs_res = bs(res.text, "lxml")
for city in bs_res.select('#selCity'):
    for city_name in city.select('option'):
        temp = []
        temp = [city_name['value'], city_name.text]
        list_city.append(temp)

# 去除第一項 "請選擇"的選項
list_city.pop(0)

# 新增 store 串列，儲存分店的資訊
store =[]

# 從各縣市撈取分店資訊，並寫入 store 串列中

for i in range(len(list_city)):
    no = list_city[i][0]
    city_name = list_city[i][1]
    
    # 開始爬網 
    url = "http://www.starbucks.com.tw/stores/storesearch.jspx"
    # post 的值需要用 raw ，否則無效，header 僅要 content-type 一項即可
    raw_data = "AJAXREQUEST=sbForm%3Aj_id_jsp_1422024916_2&name=&road=&selCity={}&selRegion=ALL&selMetroSystem=&selHighwayService=&sbForm%3Areserve=&sbForm%3Adrive=&sbForm%3Afizzio=&sbForm_SUBMIT=1&javax.faces.ViewState=rO0ABXVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAANzcgBHb3JnLmFwYWNoZS5teWZhY2VzLmFwcGxpY2F0aW9uLlRyZWVTdHJ1Y3R1cmVNYW5hZ2VyJFRyZWVTdHJ1Y3RDb21wb25lbnRGWRfYnEr2zwIABFsACV9jaGlsZHJlbnQASltMb3JnL2FwYWNoZS9teWZhY2VzL2FwcGxpY2F0aW9uL1RyZWVTdHJ1Y3R1cmVNYW5hZ2VyJFRyZWVTdHJ1Y3RDb21wb25lbnQ7TAAPX2NvbXBvbmVudENsYXNzdAASTGphdmEvbGFuZy9TdHJpbmc7TAAMX2NvbXBvbmVudElkcQB%2BAARbAAdfZmFjZXRzdAATW0xqYXZhL2xhbmcvT2JqZWN0O3hwdXIASltMb3JnLmFwYWNoZS5teWZhY2VzLmFwcGxpY2F0aW9uLlRyZWVTdHJ1Y3R1cmVNYW5hZ2VyJFRyZWVTdHJ1Y3RDb21wb25lbnQ7uqwnyBGFkKoCAAB4cAAAAAFzcQB%2BAAJ1cQB%2BAAcAAAABc3EAfgACdXEAfgAHAAAADXNxAH4AAnB0ACpvcmcuYWpheDRqc2YuYWpheC5odG1sLkh0bWxBamF4Q29tbWFuZExpbmt0ABVqX2lkX2pzcF8xNDIyMDI0OTE2XzNwc3EAfgACcHEAfgAOdAAVal9pZF9qc3BfMTQyMjAyNDkxNl80cHNxAH4AAnVxAH4ABwAAAAFzcQB%2BAAJwdAAjamF2YXguZmFjZXMuY29tcG9uZW50LlVJU2VsZWN0SXRlbXN0ABVqX2lkX2pzcF8xNDIyMDI0OTE2XzZwdAA3b3JnLmFwYWNoZS5teWZhY2VzLmNvbXBvbmVudC5odG1sLmV4dC5IdG1sU2VsZWN0T25lTWVudXQAB3NlbENpdHlwc3EAfgACcHEAfgAOdAAVal9pZF9qc3BfMTQyMjAyNDkxNl83cHNxAH4AAnVxAH4ABwAAAAFzcQB%2BAAJwcQB%2BABV0ABVqX2lkX2pzcF8xNDIyMDI0OTE2XzlwcQB%2BABd0AA5zZWxNZXRyb1N5c3RlbXBzcQB%2BAAJwcQB%2BAA50ABZqX2lkX2pzcF8xNDIyMDI0OTE2XzEwcHNxAH4AAnVxAH4ABwAAAAFzcQB%2BAAJwcQB%2BABV0ABZqX2lkX2pzcF8xNDIyMDI0OTE2XzEycHEAfgAXdAARc2VsSGlnaHdheVNlcnZpY2Vwc3EAfgACcHEAfgAOdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8xM3BzcQB%2BAAJwdAAqamF2YXguZmFjZXMuY29tcG9uZW50Lmh0bWwuSHRtbElucHV0SGlkZGVudAAHcmVzZXJ2ZXBzcQB%2BAAJwcQB%2BACp0AAVkcml2ZXBzcQB%2BAAJwcQB%2BACp0AAZmaXp6aW9wc3EAfgACcHEAfgAOdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8xN3BzcQB%2BAAJ1cQB%2BAAcAAAAEc3EAfgACcHQAKWphdmF4LmZhY2VzLmNvbXBvbmVudC5odG1sLkh0bWxPdXRwdXRUZXh0dAAGal9pZDEycHNxAH4AAnVxAH4ABwAAAAFzcQB%2BAAJ1cQB%2BAAcAAAARc3EAfgACcHEAfgA1dAAGal9pZDEzcHNxAH4AAnB0ADRvcmcuYXBhY2hlLm15ZmFjZXMuY29tcG9uZW50Lmh0bWwuZXh0Lkh0bWxPdXRwdXRUZXh0dAAWal9pZF9qc3BfMTQyMjAyNDkxNl8yMXBzcQB%2BAAJwcQB%2BADV0AAZqX2lkMTRwc3EAfgACcHEAfgA%2BdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8yMnBzcQB%2BAAJwcQB%2BADV0AAZqX2lkMTVwc3EAfgACcHEAfgA%2BdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8yM3BzcQB%2BAAJwcQB%2BADV0AAZqX2lkMTZwc3EAfgACcHEAfgA%2BdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8yNHBzcQB%2BAAJwcQB%2BADV0AAZqX2lkMTdwc3EAfgACcHEAfgA%2BdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8yNXBzcQB%2BAAJwcQB%2BADV0AAZqX2lkMThwc3EAfgACcHEAfgA%2BdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8yNnBzcQB%2BAAJwcQB%2BADV0AAZqX2lkMTlwc3EAfgACcHEAfgA%2BdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8yN3BzcQB%2BAAJwcQB%2BAD50ABZqX2lkX2pzcF8xNDIyMDI0OTE2XzI4cHNxAH4AAnBxAH4APnQAFmpfaWRfanNwXzE0MjIwMjQ5MTZfMjlwc3EAfgACcHEAfgA%2BdAAWal9pZF9qc3BfMTQyMjAyNDkxNl8zMHB0AB5qYXZheC5mYWNlcy5jb21wb25lbnQuVUlPdXRwdXR0ABZqX2lkX2pzcF8xNDIyMDI0OTE2XzIwcHQAL29yZy5hcGFjaGUubXlmYWNlcy5jdXN0b20uZGF0YWxpc3QuSHRtbERhdGFMaXN0dAAHdGJTdG9yZXBzcQB%2BAAJwcQB%2BADV0AAZqX2lkMjBwc3EAfgACcHEAfgA%2BdAAMc3RvcmVNYXBJbmZvcHQAKm9yZy5hamF4NGpzZi5hamF4Lmh0bWwuSHRtbEFqYXhPdXRwdXRQYW5lbHQAFmpfaWRfanNwXzE0MjIwMjQ5MTZfMThwdAAlb3JnLmFqYXg0anNmLmFqYXguaHRtbC5IdG1sQWpheFJlZ2lvbnQAFWpfaWRfanNwXzE0MjIwMjQ5MTZfMnB0ACNqYXZheC5mYWNlcy5jb21wb25lbnQuaHRtbC5IdG1sRm9ybXQABnNiRm9ybXB0AChvcmcuYWpheDRqc2YuZnJhbWV3b3JrLmFqYXguQWpheFZpZXdSb290dAAVal9pZF9qc3BfMTQyMjAyNDkxNl8wcHVxAH4AAAAAAAN1cQB%2BAAAAAAACdXEAfgAAAAAACHVxAH4AAAAAAAdxAH4AbXBwcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAACdAAjb3JnLmFwYWNoZS5teWZhY2VzLkZPUk1FUl9DSElMRF9JRFNzcgATamF2YS51dGlsLkFycmF5TGlzdHiB0h2Zx2GdAwABSQAEc2l6ZXhwAAAAAncEAAAAAnQABWpfaWQwcQB%2BAGt4dAAib3JnLmFwYWNoZS5teWZhY2VzLkJPVU5EX1ZJRVdfUk9PVHNyABFqYXZhLmxhbmcuQm9vbGVhbs0gcoDVnPruAgABWgAFdmFsdWV4cAF4cHBzcgAQamF2YS51dGlsLkxvY2FsZX74EWCcMPnsAwAGSQAIaGFzaGNvZGVMAAdjb3VudHJ5cQB%2BAARMAApleHRlbnNpb25zcQB%2BAARMAAhsYW5ndWFnZXEAfgAETAAGc2NyaXB0cQB%2BAARMAAd2YXJpYW50cQB%2BAAR4cP%2F%2F%2F%2F90AAJUV3QAAHQAAnpocQB%2BAH5xAH4Afnh0AApIVE1MX0JBU0lDdAAXL3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3BzcgAOamF2YS5sYW5nLkxvbmc7i%2BSQzI8j3wIAAUoABXZhbHVleHIAEGphdmEubGFuZy5OdW1iZXKGrJUdC5TgiwIAAHhwAAAAAAAAABZwcHB1cQB%2BAAAAAAAFc3EAfgB5AHEAfgCGcHEAfgCGcQB%2BAIZwc3EAfgB1AAAAAXcEAAAAAXVxAH4AAAAAAAN1cQB%2BAAAAAAAWdXEAfgAAAAAAAnVxAH4AAAAAAAdxAH4Aa3B0ABBqYXZheC5mYWNlcy5Gb3JtcQB%2BAGtzcQB%2BAHI%2FQAAAAAAADHcIAAAAEAAAAAFxAH4AdHNxAH4AdQAAAAF3BAAAAAFxAH4AaXh4cHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHNxAH4AdQAAAAF3BAAAAAF1cQB%2BAAAAAAADdXEAfgAAAAAAA3VxAH4AAAAAAAJ1cQB%2BAAAAAAAHcQB%2BAGlwdAAqb3JnLmFqYXg0anNmLmNvbXBvbmVudHMuQWpheFJlZ2lvblJlbmRlcmVydAAcc2JGb3JtOmpfaWRfanNwXzE0MjIwMjQ5MTZfMnNxAH4Acj9AAAAAAAAMdwgAAAAQAAAAAXEAfgB0c3EAfgB1AAAAGXcEAAAAGXQABWpfaWQxcQB%2BAA90AAVqX2lkMnEAfgARdAAFal9pZDNxAH4AGHQABWpfaWQ0cQB%2BABp0AAVqX2lkNXEAfgAfdAAFal9pZDZxAH4AIXQABWpfaWQ3cQB%2BACZ0AAVqX2lkOHEAfgAodAAFal9pZDlxAH4AK3EAfgAtcQB%2BAC90AAZqX2lkMTBxAH4AMXQABmpfaWQxMXEAfgBndAAGal9pZDIxeHhwcHVxAH4AAAAAAAVxAH4AhnEAfgCGcHEAfgB6cQB%2BAHpzcQB%2BAHkAcQB%2BAIZwc3EAfgB1AAAADXcEAAAADXVxAH4AAAAAAAN1cQB%2BAAAAAAAudXEAfgAAAAAABnVxAH4AAAAAAAdxAH4AD3B0AC9vcmcuYWpheDRqc2YuY29tcG9uZW50cy5BamF4Q29tbWFuZExpbmtSZW5kZXJlcnQAHHNiRm9ybTpqX2lkX2pzcF8xNDIyMDI0OTE2XzNzcQB%2BAHI%2FQAAAAAAADHcIAAAAEAAAAAB4c3IAL2phdmF4LmZhY2VzLmNvbXBvbmVudC5fQXR0YWNoZWRMaXN0U3RhdGVXcmFwcGVyyQ%2FO0SOvl4ACAAFMABFfd3JhcHBlZFN0YXRlTGlzdHQAEExqYXZhL3V0aWwvTGlzdDt4cHNxAH4AdQAAAAF3BAAAAAFzcgAramF2YXguZmFjZXMuY29tcG9uZW50Ll9BdHRhY2hlZFN0YXRlV3JhcHBlckSr5kB900%2FEAgACTAAGX2NsYXNzdAARTGphdmEvbGFuZy9DbGFzcztMABNfd3JhcHBlZFN0YXRlT2JqZWN0dAASTGphdmEvbGFuZy9PYmplY3Q7eHB2cgAdb3JnLmFqYXg0anNmLmFqYXguRm9yY2VSZW5kZXIAAAAAAAAAAAAAAHhwcHhwcQB%2BAIZxAH4AhnBzcQB%2BALJ2cgA2amF2YXguZmFjZXMuY29tcG9uZW50Ll9NZXRob2RCaW5kaW5nVG9NZXRob2RFeHByZXNzaW9uwMGqrKG%2F3XMCAAJaAA5fdHJhbnNpZW50RmxhZ0wADW1ldGhvZEJpbmRpbmd0AB5MamF2YXgvZmFjZXMvZWwvTWV0aG9kQmluZGluZzt4cgAZamF2YXguZWwuTWV0aG9kRXhwcmVzc2lvbrIvyovk9zSOAgAAeHIAE2phdmF4LmVsLkV4cHJlc3Npb26jhYpT8lrSPAIAAHhwdXEAfgAAAAAAAnQAPW9yZy5hcGFjaGUubXlmYWNlcy5lbC5jb252ZXJ0Lk1ldGhvZEV4cHJlc3Npb25Ub01ldGhvZEJpbmRpbmdzcgAib3JnLmFwYWNoZS5lbC5NZXRob2RFeHByZXNzaW9uSW1wbIegP7lep%2FRPDAAAeHEAfgC7dzEAHSN7c3RvcmVTZWFyY2hCZWFuLmZpbmRCeU5hbWV9ABBqYXZhLmxhbmcuT2JqZWN0dXIAE1tMamF2YS5sYW5nLlN0cmluZzut0lbn6R17RwIAAHhwAAAAAHBweHB0ABV0YlN0b3JlLCBzdG9yZU1hcEluZm9wcHBwc3IAEWphdmEubGFuZy5JbnRlZ2VyEuKgpPeBhzgCAAFJAAV2YWx1ZXhxAH4AgwAAAGRxAH4AenNxAH4AeQFxAH4AenBwcHQAGWNvbDMgYnRuIGJ0bjIgZ3JlZW5NZWRpdW1zcQB%2BAHkAcQB%2BAIZ0ABdtYXNrSGlkZSgpO3Jlc3VsdFNob3coKXBwcHBwcHNxAH4AeQBxAH4AhnBwcHBxAH4AfnBwcHBwcHBwcHNxAH4AeQBxAH4AhnB0ABZtYXNrU2hvdygpO3RpdGxlSGlkZSgpcHNxAH4AxQAATiBxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAAC51cQB%2BAAAAAAAGdXEAfgAAAAAAB3EAfgARcHEAfgCrdAAcc2JGb3JtOmpfaWRfanNwXzE0MjIwMjQ5MTZfNHNxAH4Acj9AAAAAAAAMdwgAAAAQAAAAAHhzcQB%2BAK5zcQB%2BAHUAAAABdwQAAAABc3EAfgCycQB%2BALdweHBxAH4AhnEAfgCGcHNxAH4AsnEAfgC9dXEAfgAAAAAAAnEAfgC%2Fc3EAfgDAdzEAHSN7c3RvcmVTZWFyY2hCZWFuLmZpbmRCeVJvYWR9ABBqYXZhLmxhbmcuT2JqZWN0dXEAfgDCAAAAAHBweHBxAH4AxHBwcHBzcQB%2BAMUAAABkcQB%2BAHpzcQB%2BAHkBcQB%2BAHpwcHBxAH4AyHNxAH4AeQBxAH4AhnQAISQoJyNkaXZNYXNrJykuaGlkZSgpO3Jlc3VsdFNob3coKXBwcHBwcHNxAH4AeQBxAH4AhnBwcHBxAH4AfnBwcHBwcHBwcHNxAH4AeQBxAH4AhnBxAH4AzXBzcQB%2BAMUAAE4gcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAANdXEAfgAAAAAAHXVxAH4AAAAAAA51cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgAYcHQAF29yZy5hcGFjaGUubXlmYWNlcy5NZW51cHNxAH4Acj9AAAAAAAAMdwgAAAAQAAAAAXEAfgB0c3EAfgB1AAAAAXcEAAAAAXEAfgAWeHhwc3EAfgByP4AAAAAAAAJ3CAAAAAIAAAACdAAFdmFsdWVzcgAnb3JnLmFwYWNoZS5qYXNwZXIuZWwuSnNwVmFsdWVFeHByZXNzaW9uYVnt3jAUuDwMAAB4cgAYamF2YXguZWwuVmFsdWVFeHByZXNzaW9udwqAW%2BDA%2FpECAAB4cQB%2BALx3PAA6L3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMjEyLDgpICcje3N0b3JlU2VhcmNoQmVhbi5jaXR5SWR9J3NyACFvcmcuYXBhY2hlLmVsLlZhbHVlRXhwcmVzc2lvbkltcGwhMUqQommCAgwAAHhxAH4A73ctABkje3N0b3JlU2VhcmNoQmVhbi5jaXR5SWR9ABBqYXZhLmxhbmcuT2JqZWN0cHB4eHQAB2JpbmRpbmdzcQB%2BAO53PQA7L3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMjEyLDgpICcje3N0b3JlU2VhcmNoQmVhbi5zZWxDaXR5fSdzcQB%2BAPF3PwAaI3tzdG9yZVNlYXJjaEJlYW4uc2VsQ2l0eX0AIWphdmF4LmZhY2VzLmNvbXBvbmVudC5VSUNvbXBvbmVudHBweHh4cHBxAH4AhnEAfgCGcQB%2BAIZxAH4AhnBwcHBwcHEAfgB6cQB%2BAIZwcHQAEXNlbENpdHlPbkNoYW5nZSgpcHEAfgCGcQB%2BAIZxAH4AhnEAfgCGcHQABGNvbDZwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcQB%2BAIZxAH4AhnBwcHBwcQB%2BAHpxAH4AenBzcQB%2BAHUAAAABdwQAAAABdXEAfgAAAAAAA3VxAH4AAAAAAAJ1cQB%2BAAAAAAAHcQB%2BABZwcHBzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHNxAH4Acj%2BAAAAAAAABdwgAAAABAAAAAXEAfgDtc3EAfgDudz8APS9zdG9yZXMvc3RvcmVzZWFyY2guanNwKDIxOCw5KSAnI3tzdG9yZVNlYXJjaEJlYW4uY2l0eUl0ZW1zfSdzcQB%2BAPF3MAAcI3tzdG9yZVNlYXJjaEJlYW4uY2l0eUl0ZW1zfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBweHVxAH4AAAAAAAN1cQB%2BAAAAAAAudXEAfgAAAAAABnVxAH4AAAAAAAdxAH4AGnBxAH4Aq3QAHHNiRm9ybTpqX2lkX2pzcF8xNDIyMDI0OTE2XzdzcQB%2BAHI%2FQAAAAAAADHcIAAAAEAAAAAB4c3EAfgCuc3EAfgB1AAAAAXcEAAAAAXNxAH4AsnEAfgC3cHhwcQB%2BAIZxAH4AhnBzcQB%2BALJxAH4AvXVxAH4AAAAAAAJxAH4Av3NxAH4AwHczAB8je3N0b3JlU2VhcmNoQmVhbi5maW5kQnlSZWdpb259ABBqYXZhLmxhbmcuT2JqZWN0dXEAfgDCAAAAAHBweHBxAH4AxHBwcHBzcQB%2BAMUAAABkcQB%2BAHpzcQB%2BAHkBcQB%2BAHpwcHBxAH4AyHNxAH4AeQBxAH4AhnEAfgDfcHBwcHBwc3EAfgB5AHEAfgCGcHBwcHEAfgB%2BcHBwcHBwcHBwc3EAfgB5AHEAfgCGcHEAfgDNcHNxAH4AxQAATiBxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAAA11cQB%2BAAAAAAAddXEAfgAAAAAADnVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAB9wcQB%2BAOlwc3EAfgByP0AAAAAAAAx3CAAAABAAAAABcQB%2BAHRzcQB%2BAHUAAAABdwQAAAABcQB%2BAB54eHBzcQB%2BAHI%2FgAAAAAAAAncIAAAAAgAAAAJxAH4A7XNxAH4A7nc9ADsvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgyMzcsOCkgJyN7c3RvcmVTZWFyY2hCZWFuLm1ldHJvSWR9J3NxAH4A8XcuABoje3N0b3JlU2VhcmNoQmVhbi5tZXRyb0lkfQAQamF2YS5sYW5nLk9iamVjdHBweHhxAH4A83NxAH4A7ndEAEIvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgyMzcsOCkgJyN7c3RvcmVTZWFyY2hCZWFuLnNlbE1ldHJvU3lzdGVtfSdzcQB%2BAPF3RgAhI3tzdG9yZVNlYXJjaEJlYW4uc2VsTWV0cm9TeXN0ZW19ACFqYXZheC5mYWNlcy5jb21wb25lbnQuVUlDb21wb25lbnRwcHh4eHBwcQB%2BAIZxAH4AhnEAfgCGcQB%2BAIZwcHBwcHBxAH4AenEAfgCGcHB0ABhzZWxNZXRyb1N5c3RlbU9uQ2hhbmdlKClwcQB%2BAIZxAH4AhnEAfgCGcQB%2BAIZ0AAp3aWR0aDo3OXB4dAAJY29sLXhzLTEycHBwcHBwcHBwcHBwcHBwcHBwcHBwcHEAfgCGcQB%2BAIZwcHBwcHEAfgB6cQB%2BAHpwc3EAfgB1AAAAAXcEAAAAAXVxAH4AAAAAAAN1cQB%2BAAAAAAACdXEAfgAAAAAAB3EAfgAecHBwc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7ndGAEQvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgyNDQsOSkgJyN7c3RvcmVTZWFyY2hCZWFuLm1ldHJvU3lzdGVtSXRlbXN9J3NxAH4A8Xc3ACMje3N0b3JlU2VhcmNoQmVhbi5tZXRyb1N5c3RlbUl0ZW1zfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBweHVxAH4AAAAAAAN1cQB%2BAAAAAAAudXEAfgAAAAAABnVxAH4AAAAAAAdxAH4AIXBxAH4Aq3QAHXNiRm9ybTpqX2lkX2pzcF8xNDIyMDI0OTE2XzEwc3EAfgByP0AAAAAAAAx3CAAAABAAAAAAeHNxAH4ArnNxAH4AdQAAAAF3BAAAAAFzcQB%2BALJxAH4At3B4cHEAfgCGcQB%2BAIZwc3EAfgCycQB%2BAL11cQB%2BAAAAAAACcQB%2BAL9zcQB%2BAMB3OQAlI3tzdG9yZVNlYXJjaEJlYW4uZmluZEJ5TWV0cm9TdGF0aW9ufQAQamF2YS5sYW5nLk9iamVjdHVxAH4AwgAAAABwcHhwcQB%2BAMRwcHBwc3EAfgDFAAAAZHEAfgB6c3EAfgB5AXEAfgB6cHBwcQB%2BAMhzcQB%2BAHkAcQB%2BAIZxAH4AynBwcHBwcHNxAH4AeQBxAH4AhnBwcHBxAH4AfnBwcHBwcHBwcHNxAH4AeQBxAH4AhnBxAH4AzXBzcQB%2BAMUAAE4gcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAANdXEAfgAAAAAAHXVxAH4AAAAAAA51cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgAmcHEAfgDpcHNxAH4Acj9AAAAAAAAMdwgAAAAQAAAAAXEAfgB0c3EAfgB1AAAAAXcEAAAAAXEAfgAleHhwc3EAfgByP4AAAAAAAAJ3CAAAAAIAAAACcQB%2BAO1zcQB%2BAO53RgBEL3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMjY1LDgpICcje3N0b3JlU2VhcmNoQmVhbi5oaWdod2F5U2VydmljZUlkfSdzcQB%2BAPF3NwAjI3tzdG9yZVNlYXJjaEJlYW4uaGlnaHdheVNlcnZpY2VJZH0AEGphdmEubGFuZy5PYmplY3RwcHh4cQB%2BAPNzcQB%2BAO53RwBFL3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMjY1LDgpICcje3N0b3JlU2VhcmNoQmVhbi5zZWxIaWdod2F5U2VydmljZX0nc3EAfgDxd0kAJCN7c3RvcmVTZWFyY2hCZWFuLnNlbEhpZ2h3YXlTZXJ2aWNlfQAhamF2YXguZmFjZXMuY29tcG9uZW50LlVJQ29tcG9uZW50cHB4eHhwcHEAfgCGcQB%2BAIZxAH4AhnEAfgCGcHBwcHBwcQB%2BAHpxAH4AhnBwcHBxAH4AhnEAfgCGcQB%2BAIZxAH4AhnQAC3dpZHRoOjE1MHB4dAAFY29sMTJwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcQB%2BAIZxAH4AhnBwcHBwcQB%2BAHpxAH4AenBzcQB%2BAHUAAAABdwQAAAABdXEAfgAAAAAAA3VxAH4AAAAAAAJ1cQB%2BAAAAAAAHcQB%2BACVwcHBzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHNxAH4Acj%2BAAAAAAAABdwgAAAABAAAAAXEAfgDtc3EAfgDud0kARy9zdG9yZXMvc3RvcmVzZWFyY2guanNwKDI2Niw5KSAnI3tzdG9yZVNlYXJjaEJlYW4uaGlnaHdheVNlcnZpY2VJdGVtc30nc3EAfgDxdzoAJiN7c3RvcmVTZWFyY2hCZWFuLmhpZ2h3YXlTZXJ2aWNlSXRlbXN9ABBqYXZhLmxhbmcuT2JqZWN0cHB4eHhwcHB4dXEAfgAAAAAAA3VxAH4AAAAAAC51cQB%2BAAAAAAAGdXEAfgAAAAAAB3EAfgAocHEAfgCrdAAdc2JGb3JtOmpfaWRfanNwXzE0MjIwMjQ5MTZfMTNzcQB%2BAHI%2FQAAAAAAADHcIAAAAEAAAAAB4c3EAfgCuc3EAfgB1AAAAAXcEAAAAAXNxAH4AsnEAfgC3cHhwcQB%2BAIZxAH4AhnBzcQB%2BALJxAH4AvXVxAH4AAAAAAAJxAH4Av3NxAH4AwHc0ACAje3N0b3JlU2VhcmNoQmVhbi5maW5kQnlIaWdod2F5fQAQamF2YS5sYW5nLk9iamVjdHVxAH4AwgAAAABwcHhwcQB%2BAMRwcHBwc3EAfgDFAAAAZHEAfgB6c3EAfgB5AXEAfgB6cHBwcQB%2BAMhzcQB%2BAHkAcQB%2BAIZxAH4AynBwcHBwcHNxAH4AeQBxAH4AhnBwcHBxAH4AfnBwcHBwcHBwcHNxAH4AeQBxAH4AhnBxAH4AzXBzcQB%2BAMUAAE4gcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAAOdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AK3B0ABJqYXZheC5mYWNlcy5IaWRkZW50AA5zYkZvcm06cmVzZXJ2ZXNxAH4Acj9AAAAAAAAQdwgAAAAQAAAAAHhwc3EAfgByP4AAAAAAAAF3CAAAAAEAAAABcQB%2BAO1zcQB%2BAO53PQA7L3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMjg4LDgpICcje3N0b3JlU2VhcmNoQmVhbi5yZXNlcnZlfSdzcQB%2BAPF3LgAaI3tzdG9yZVNlYXJjaEJlYW4ucmVzZXJ2ZX0AEGphdmEubGFuZy5PYmplY3RwcHh4eHBwcQB%2BAIZxAH4AhnEAfgCGcQB%2BAIZwcHBwcHBxAH4AenEAfgCGcHBwdXEAfgAAAAAAA3VxAH4AAAAAAA51cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgAtcHEAfgFsdAAMc2JGb3JtOmRyaXZlc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7nc8ADovc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgyODksMjYpICcje3N0b3JlU2VhcmNoQmVhbi5kcml2ZX0nc3EAfgDxdywAGCN7c3RvcmVTZWFyY2hCZWFuLmRyaXZlfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBxAH4AhnEAfgCGcQB%2BAIZxAH4AhnBwcHBwcHEAfgB6cQB%2BAIZwcHB1cQB%2BAAAAAAADdXEAfgAAAAAADnVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAC9wcQB%2BAWx0AA1zYkZvcm06Zml6emlvc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7nc9ADsvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgyOTAsMjYpICcje3N0b3JlU2VhcmNoQmVhbi5maXp6aW99J3NxAH4A8XctABkje3N0b3JlU2VhcmNoQmVhbi5maXp6aW99ABBqYXZhLmxhbmcuT2JqZWN0cHB4eHhwcHEAfgCGcQB%2BAIZxAH4AhnEAfgCGcHBwcHBwcQB%2BAHpxAH4AhnBwcHVxAH4AAAAAAAN1cQB%2BAAAAAAAudXEAfgAAAAAABnVxAH4AAAAAAAdxAH4AMXBxAH4Aq3QAHXNiRm9ybTpqX2lkX2pzcF8xNDIyMDI0OTE2XzE3c3EAfgByP0AAAAAAAAx3CAAAABAAAAAAeHNxAH4ArnNxAH4AdQAAAAF3BAAAAAFzcQB%2BALJxAH4At3B4cHEAfgCGcQB%2BAIZwc3EAfgCycQB%2BAL11cQB%2BAAAAAAACcQB%2BAL9zcQB%2BAMB3MQAdI3tzdG9yZVNlYXJjaEJlYW4uZmluZEJ5VHlwZX0AEGphdmEubGFuZy5PYmplY3R1cQB%2BAMIAAAAAcHB4cHEAfgDEcHBwcHNxAH4AxQAAAGRxAH4AenNxAH4AeQFxAH4AenBwcHEAfgDIc3EAfgB5AHEAfgCGcQB%2BAN9wcHBwcHBzcQB%2BAHkAcQB%2BAIZwcHBwcQB%2BAH5wcHBwcHBwcHBzcQB%2BAHkAcQB%2BAIZwcQB%2BAM1wc3EAfgDFAABOIHEAfgB6cHB1cQB%2BAAAAAAADdXEAfgAAAAAAFXVxAH4AAAAAAAdxAH4AZ3B0AC9vcmcuYWpheDRqc2YuY29tcG9uZW50cy5BamF4T3V0cHV0UGFuZWxSZW5kZXJlcnQAHXNiRm9ybTpqX2lkX2pzcF8xNDIyMDI0OTE2XzE4c3EAfgByP0AAAAAAAAx3CAAAABAAAAABcQB%2BAHRzcQB%2BAHUAAAAEdwQAAAAEcQB%2BADZxAH4AYXEAfgBjcQB%2BAGV4eHBwcHBwcHBzcQB%2BAHkAcQB%2BAIZwcHNxAH4AeQFxAH4AhnBwcHBwcHBwcHBzcQB%2BAHUAAAAEdwQAAAAEdXEAfgAAAAAAA3VxAH4AAAAAAAh1cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgA2cHQAEGphdmF4LmZhY2VzLlRleHRwc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBwdAAnDQoJCQkJCTx1bCBjbGFzcz0ic2VhcmNoX3N0b3JlIj4NCgkJCQkJcHBwcHBwcQB%2BAIZxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAAAd1cQB%2BAAAAAAAEdXEAfgAAAAAAH3VxAH4AAAAAAAd1cQB%2BAAAAAAAHcQB%2BAGFwdAAXb3JnLmFwYWNoZS5teWZhY2VzLkxpc3R0AA5zYkZvcm06dGJTdG9yZXNxAH4Acj9AAAAAAAAMdwgAAAAQAAAAAXEAfgB0c3EAfgB1AAAAAXcEAAAAAXEAfgBfeHhwc3EAfgByP4AAAAAAAAF3CAAAAAEAAAABcQB%2BAO1zcQB%2BAO53QAA%2BL3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMzEwLDUpICcje3N0b3JlU2VhcmNoQmVhbi5zdG9yZU1vZGVsfSdzcQB%2BAPF3MQAdI3tzdG9yZVNlYXJjaEJlYW4uc3RvcmVNb2RlbH0AEGphdmEubGFuZy5PYmplY3RwcHh4eHB0AAVzdG9yZXNxAH4AxQAAAABxAH4AhnEAfgG2cQB%2BAIZwcQB%2BAbZxAH4AenQAATBxAH4Bt3BwcHBwcHB0AAQxMDAlcHBwcHBwcHBwcHBwcHBwcHBwcQB%2BAIZxAH4AenBwdAAGc2ltcGxlcHBwcHNxAH4AdQAAAAF3BAAAAAF1cQB%2BAAAAAAADdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AX3EAfgB6cQB%2BAaVwc3EAfgByP0AAAAAAAAx3CAAAABAAAAADcQB%2BAHRzcQB%2BAHUAAAARdwQAAAARcQB%2BADxxAH4AP3EAfgBBcQB%2BAENxAH4ARXEAfgBHcQB%2BAElxAH4AS3EAfgBNcQB%2BAE9xAH4AUXEAfgBTcQB%2BAFVxAH4AV3EAfgBZcQB%2BAFtxAH4AXXh0AAxmb3JjZUlkSW5kZXhxAH4AenQABmVzY2FwZXEAfgCGeHBwdAA5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY%2BDQoJCQkJCQk8L2xpPg0KCQkJCQkJcHBzcQB%2BAHUAAAARdwQAAAARdXEAfgAAAAAAA3VxAH4AAAAAAAh1cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgA8cHEAfgGlcHNxAH4Acj9AAAAAAAAQdwgAAAAQAAAAAHhwcHQAMA0KCQkJCQkJPCEtLSAgPGxpIGNsYXNzPSJzZWxlY3RlZCI%2BICAtLT4NCgkJCQkJCXBwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAASdXEAfgAAAAAACHVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAD9wdAAXb3JnLmFwYWNoZS5teWZhY2VzLlRleHRwc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7nc4ADYvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgzMTMsNikgJyN7c3RvcmUuc2VhcmNoQWN0aW9ufSdzcQB%2BAPF3KQAVI3tzdG9yZS5zZWFyY2hBY3Rpb259ABBqYXZhLmxhbmcuT2JqZWN0cHB4eHhwcHBwcHBwcQB%2BAIZxAH4AenBwcHBwcHBwcHBwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AQXBxAH4BpXBzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHB0AA0NCgkJCQkJCQk8aDM%2BcHBwcHBwcQB%2BAIZxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAABJ1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AQ3BxAH4Bz3BzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHNxAH4Acj%2BAAAAAAAABdwgAAAABAAAAAXEAfgDtc3EAfgDudzcANS9zdG9yZXMvc3RvcmVzZWFyY2guanNwKDMxNCwxMSkgJyN7c3RvcmUuc3RvcmVOYW1lQ30nc3EAfgDxdycAEyN7c3RvcmUuc3RvcmVOYW1lQ30AEGphdmEubGFuZy5PYmplY3RwcHh4eHBwcHBwcHBxAH4AhnEAfgCGcHBwcHBwcHBwcHBwcHBwcQB%2BAIZxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAAAh1cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgBFcHEAfgGlcHNxAH4Acj9AAAAAAAAQdwgAAAAQAAAAAHhwcHQABiZuYnNwO3BwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAASdXEAfgAAAAAACHVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAEdwcQB%2BAc9wc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7nc3ADUvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgzMTQsNjEpICcje3N0b3JlLnN0b3JlTmFtZUV9J3NxAH4A8XcnABMje3N0b3JlLnN0b3JlTmFtZUV9ABBqYXZhLmxhbmcuT2JqZWN0cHB4eHhwcHBwcHBwcQB%2BAIZxAH4AhnBwcHBwcHBwcHBwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4ASXBxAH4BpXBzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHB0ACE8L2gzPg0KCQkJCQkJCTxwIGNsYXNzPSJhZGRyZXNzIj5wcHBwcHBxAH4AhnEAfgB6cHB1cQB%2BAAAAAAADdXEAfgAAAAAAEnVxAH4AAAAAAAh1cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgBLcHEAfgHPcHNxAH4Acj9AAAAAAAAQdwgAAAAQAAAAAHhwc3EAfgByP4AAAAAAAAF3CAAAAAEAAAABcQB%2BAO1zcQB%2BAO53iwCJL3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMzE1LDI2KSAnI3tzdG9yZS5jaXR5PT1udWxsPyIiOnN0b3JlLmNpdHkuY2l0eU5hbWV9I3tzdG9yZS5yZWdpb249PW51bGw%2FIiI6c3RvcmUucmVnaW9uLnJlZ2lvbk5hbWV9I3tzdG9yZS5hZGRyfSdzcQB%2BAPF3ewBnI3tzdG9yZS5jaXR5PT1udWxsPyIiOnN0b3JlLmNpdHkuY2l0eU5hbWV9I3tzdG9yZS5yZWdpb249PW51bGw%2FIiI6c3RvcmUucmVnaW9uLnJlZ2lvbk5hbWV9I3tzdG9yZS5hZGRyfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBwcHBwcHEAfgCGcQB%2BAIZwcHBwcHBwcHBwcHBwcHBxAH4AhnEAfgB6cHB1cQB%2BAAAAAAADdXEAfgAAAAAACHVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAE1wcQB%2BAaVwc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBwdAAcPC9wPg0KCQkJCQkJCTxwIGNsYXNzPSJ0ZWwiPnBwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAASdXEAfgAAAAAACHVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAE9wcQB%2BAc9wc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7ncwAC4vc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgzMTYsMjIpICcje3N0b3JlLnRlbH0nc3EAfgDxdyAADCN7c3RvcmUudGVsfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBwcHBwcHEAfgCGcQB%2BAIZwcHBwcHBwcHBwcHBwcHBxAH4AhnEAfgB6cHB1cQB%2BAAAAAAADdXEAfgAAAAAACHVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAFFwcQB%2BAaVwc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBwdAAePC9wPg0KCQkJCQkJCTxwIGNsYXNzPSJob3VycyI%2BcHBwcHBwcQB%2BAIZxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAABJ1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AU3BxAH4Bz3BzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHNxAH4Acj%2BAAAAAAAABdwgAAAABAAAAAXEAfgDtc3EAfgDudzkANy9zdG9yZXMvc3RvcmVzZWFyY2guanNwKDMxNywyNCkgJyN7c3RvcmUuYnVzaW5lc3NUaW1lfSdzcQB%2BAPF3KQAVI3tzdG9yZS5idXNpbmVzc1RpbWV9ABBqYXZhLmxhbmcuT2JqZWN0cHB4eHhwcHBwcHBwcQB%2BAIZxAH4AhnBwcHBwcHBwcHBwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AVXBxAH4BpXBzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHB0ACk8L3A%2BDQoJCQkJCQkJPGRpdiBjbGFzcz0iaWNvbiI%2BDQoJCQkJCQkJCXBwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAASdXEAfgAAAAAACHVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAFdwcQB%2BAc9wc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7nd1AHMvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgzMTksOCkgJyN7c3RvcmUud2lyZWxlc3M9PTE%2FIjxpbWcgc3JjPVwib2JqZWN0cy9pbWFnZXMvc3RvcmVzZWFyY2gvaWNvbl93aWZpLmpwZ1wiLz4iOiIiIH0nc3EAfgDxd2YAUiN7c3RvcmUud2lyZWxlc3M9PTE%2FIjxpbWcgc3JjPVwib2JqZWN0cy9pbWFnZXMvc3RvcmVzZWFyY2gvaWNvbl93aWZpLmpwZ1wiLz4iOiIiIH0AEGphdmEubGFuZy5PYmplY3RwcHh4eHBwcHBwcHBxAH4AhnEAfgB6cHBwcHBwcHBwcHBwcHBwcQB%2BAIZxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAABJ1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AWXBxAH4Bz3BzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHNxAH4Acj%2BAAAAAAAABdwgAAAABAAAAAXEAfgDtc3EAfgDud34AfC9zdG9yZXMvc3RvcmVzZWFyY2guanNwKDMyMCw4KSAnI3tzdG9yZS5yZXNlcnZlQ29mZmU9PSIxIj8iPGltZyBzcmM9XCJvYmplY3RzL2ltYWdlcy9zdG9yZXNlYXJjaC9pY29uX3Jlc2VydmUuanBnXCIvPiI6IiIgfSdzcQB%2BAPF3bwBbI3tzdG9yZS5yZXNlcnZlQ29mZmU9PSIxIj8iPGltZyBzcmM9XCJvYmplY3RzL2ltYWdlcy9zdG9yZXNlYXJjaC9pY29uX3Jlc2VydmUuanBnXCIvPiI6IiIgfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBwcHBwcHEAfgCGcQB%2BAHpwcHBwcHBwcHBwcHBwcHBxAH4AhnEAfgB6cHB1cQB%2BAAAAAAADdXEAfgAAAAAAEnVxAH4AAAAAAAh1cQB%2BAAAAAAADdXEAfgAAAAAAB3EAfgBbcHEAfgHPcHNxAH4Acj9AAAAAAAAQdwgAAAAQAAAAAHhwc3EAfgByP4AAAAAAAAF3CAAAAAEAAAABcQB%2BAO1zcQB%2BAO53egB4L3N0b3Jlcy9zdG9yZXNlYXJjaC5qc3AoMzIxLDI5KSAnI3tzdG9yZS5kcml2ZVRocnU9PSIxIj8iPGltZyBzcmM9XCJvYmplY3RzL2ltYWdlcy9zdG9yZXNlYXJjaC9pY29uX2RyaXZlLmpwZ1wiLz4iOiIiIH0nc3EAfgDxd2oAViN7c3RvcmUuZHJpdmVUaHJ1PT0iMSI%2FIjxpbWcgc3JjPVwib2JqZWN0cy9pbWFnZXMvc3RvcmVzZWFyY2gvaWNvbl9kcml2ZS5qcGdcIi8%2BIjoiIiB9ABBqYXZhLmxhbmcuT2JqZWN0cHB4eHhwcHBwcHBwcQB%2BAIZxAH4AenBwcHBwcHBwcHBwcHBwcHEAfgCGcQB%2BAHpwcHVxAH4AAAAAAAN1cQB%2BAAAAAAASdXEAfgAAAAAACHVxAH4AAAAAAAN1cQB%2BAAAAAAAHcQB%2BAF1wcQB%2BAc9wc3EAfgByP0AAAAAAABB3CAAAABAAAAAAeHBzcQB%2BAHI%2FgAAAAAAAAXcIAAAAAQAAAAFxAH4A7XNxAH4A7nd4AHYvc3RvcmVzL3N0b3Jlc2VhcmNoLmpzcCgzMjIsMjkpICcje3N0b3JlLmZpenppbz09IjEiPyI8aW1nIHNyYz1cIm9iamVjdHMvaW1hZ2VzL3N0b3Jlc2VhcmNoL2ljb25fZml6emlvLmpwZ1wiLz4iOiIiIH0nc3EAfgDxd2gAVCN7c3RvcmUuZml6emlvPT0iMSI%2FIjxpbWcgc3JjPVwib2JqZWN0cy9pbWFnZXMvc3RvcmVzZWFyY2gvaWNvbl9maXp6aW8uanBnXCIvPiI6IiIgfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBwcHBwcHEAfgCGcQB%2BAHpwcHBwcHBwcHBwcHBwcHBxAH4AhnEAfgB6cHB4eHVxAH4AAAAAAAN1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AY3BxAH4BpXBzcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHB0ABMNCgkJCQkJPC91bD4NCgkJCQkJcHBwcHBwcQB%2BAIZxAH4AenBwdXEAfgAAAAAAA3VxAH4AAAAAABJ1cQB%2BAAAAAAAIdXEAfgAAAAAAA3VxAH4AAAAAAAdxAH4AZXBxAH4Bz3QAE3NiRm9ybTpzdG9yZU1hcEluZm9zcQB%2BAHI%2FQAAAAAAAEHcIAAAAEAAAAAB4cHNxAH4Acj%2BAAAAAAAABdwgAAAABAAAAAXEAfgDtc3EAfgDud0IAQC9zdG9yZXMvc3RvcmVzZWFyY2guanNwKDMyOCw1KSAnI3tzdG9yZVNlYXJjaEJlYW4uc3RvcmVNYXBJbmZvfSdzcQB%2BAPF3MwAfI3tzdG9yZVNlYXJjaEJlYW4uc3RvcmVNYXBJbmZvfQAQamF2YS5sYW5nLk9iamVjdHBweHh4cHBwcHBwcHEAfgCGcQB%2BAHpwcHBwcHBwcHBwcHBwcHBxAH4AhnEAfgB6cHB4eHh4cQB%2BAIE%3D&sbForm%3Aj_id_jsp_1422024916_7=sbForm%3Aj_id_jsp_1422024916_7&".format(no)
    headers = {'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8'}
    res = requests.post(url, data=raw_data, headers = headers)
    bs_res = bs(res.text, "lxml")
    
    # 因為經緯度在 onclick 中，故將該 li 的內容轉為文字，再用 re 濾出
    s_name = bs_res.select('h3')
    s_add = bs_res.select('.address')
    s_li = bs_res.select('li')
    
    for i in range(len(s_name)):
        t = []
        t.append(city_name)
        regex_store = re.compile('(\w)+')  
        t.append(regex_store.search(s_name[i].string).group())
        t.append(s_add[i].string)
        
        # 將 li 的值轉成文字後，再用正則表示式取出 x,y
        str_li = str(s_li[i])
        regex_xy = re.compile(r'(\d{2,3})[.]+(\d{2,10})')
        xy = regex_xy.findall(str_li)
        t.append(xy[1][0]+'.'+xy[1][1])
        t.append(xy[0][0]+'.'+xy[0][1])
        store.append(t)

# 加上欄位名稱，並寫入csv檔案

header=['county', 'store_nm', 'store_add', 'x', 'y']
store.insert( 0, header)
with open('starbucks_store.csv', 'wt') as myfile:
    csvout = csv.writer(myfile)
    csvout.writerows( store)
